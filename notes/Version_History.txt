 * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
 *                                                                 *
 * Copyright (C) 1998-2023 Timothy E. Dowling                      *
 *                                                                 *
 * This program is free software; you can redistribute it and/or   *
 * modify it under the terms of the GNU General Public License     *
 * as published by the Free Software Foundation; either version 2  *
 * of the License, or (at your option) any later version.          *
 * A copy of this License is in the file:                          *
 *   $EPIC4_PATH/License.txt                                       *
 *                                                                 *
 * This program is distributed in the hope that it will be useful, *
 * but WITHOUT ANY WARRANTY; without even the implied warranty of  *
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.            *
 *                                                                 *
 * You should have received a copy of the GNU General Public       *
 * License along with this program; if not, write to the Free      *
 * Software Foundation, Inc., 51 Franklin Street, Fifth Floor,     *
 * Boston, MA 02110-1301, USA.                                     *
 *                                                                 *
 * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *

=====================================================================
The Explicit Planetary Isentropic Coordinate (EPIC) Atmospheric Model
                        Version History
=====================================================================

============
Version 5.23
============

T. Dowling (8/2023):

 1) The model is now decomposed in both horizontal dimensions for
    parallel computers (previously it was decomposed, or 'cut', only
    in the latitude dimension). For high-resolution runs, this means
    users may now benefit from running a job on hundreds of cpu cores.

 2) The hyperviscosity model has been changed back to the form originally
    described in Dowling et al. (1998).  It was found that the Dowling
    et al (2006) form, which approximated the horizontal Laplacian with
    separate 1D zonal and meridional passes, tended to allow unphysical
    computational modes that were orientated at a 45deg angle (i.e.
    southwest-to-northeast or southeast-to-northwest).

 3) In epic/tools/C is a new tool called t_vs_p_smoother. This applies
    a weak diffusion to the temperature profile in an EPIC t_vs_p file,
    which may clear up minor "dsgth < 0" errors when running initial, 
    in particular ones generated by small glitches in T(p) that result
    in slightly superadiabatic regions. The strength of the diffusion
    is controlled by mudat in the tool's source code.
      There is also epic/data/Jupiter/gen_t_vs_p.c, which allows for
    an N2_floor, and smooths with a Savitzky-Golay filter.

 4) The netcdf library is updated to version 4 (from version 3), which
    enables input of HDF5 format data (used to convert OpenMars data 
    via 'change -openmars' for isentropic-coordinate analysis).
    This means that the linux platform needs to have installed (using 
    zypper as an example installer): 
      sudo zypper install curl libcurl-devel
      sudo zypper install hdf5 hdf5-devel hdf5-devel-data hdf5-devel-static

 5) For isobaric and hybrid coordinate models, when the turbulence model is 
    off, an enthalpy-conserving, relaxed adiabatic-adjustment scheme is 
    applied to superadiabatic (N^2 < 0) regions (the isentropic coordinate 
    model does not run with superadiabatic regions). When the turbulence 
    model is on, it has enhanced diffusion in superadiabatic regions to 
    achieve relaxed adiabatic adjustment. However, the vertical component 
    of the current turbulence model, which can be isolated in this version, 
    appears to be too strong because it dissipates jovian vortices in a 
    few weeks, and so it is usually turned off (this needs further 
    investigation).

 6) The ortho-para hydrogen conversion rate now follows Huestis (2008, 
    Planet. Space Sci. 56, 1733--1743), which is a fit to H2+H2 collision 
    laboratory data. For Uranus and Neptune, at 1 bar is ~7 times faster
    than the rate used in Dowling et. al (1998). In addition, the value 
    of fpara in the case when FPARA is not turned on as a variable is now 
    the equilibrium value based on the local temperature, rather than the 
    high-temperature value of 0.25. This is important for Uranus and 
    Neptune, who are cold enough to naturally exhibit the full range of 
    fpara from 0.25 to 1.00.

 7) Fixed known bugs.

===========
Version 5.1
===========

T. Dowling (1/2016):

 1) The EPICwiki site has been discontinued (it was overrun by
    spammers, and was deemed a firewall security risk at U. Louisville).
    In its place, the model now has it own Google Scholar page: 
      https://scholar.google.com/citations?user=6LJV7-UAAAAJ&hl=en

 2) Fixed known bugs.

===========
Version 5.0
===========

T. Dowling (10/2013):

 1) Accurate gaseous radiative transfer (RT), useful for calculating
    heating and cooling in stratospheres, is implemented, based on the
    seasonal model by Tommy Greathouse.  The five bands FIR, MIDIR, NIR,
    VIS and UV are included.  The correlated-k distribution method is
    used for the line-intensive bands. (NOTE: Clouds are not yet coupled
    to the radiative transfer).

 2) The user now chooses the vertical coordinate from the options
    isobaric, isentropic or hybrid (isentropic-sigma).

 3) Hyperviscosity is now automatically tuned to the optimal value for
    suppressing grid-scale computational modes, and high orders are
    available.

 4) We have returned to vertical staggering of the variables.
    The winds, U and V, are carried in the layer, and the pressures,
    potential temperatures, and condensable species are carried
    on the interfaces.

 5) In addition to the usual Coriolis parameter and second Coriolis
    parameter, grid.f[jj] and grid.f2[jj], where jj refers to the doubled
    index notation used to handle the staggered C-grids, the model
    now includes grid.beta[jj], where beta = df/dy.

 6) The model's path variable is back to "EPIC_PATH".

 7) Fixed known bugs.

===========
Version 4.3
===========

T. Dowling (09/2010):

 1) The model variables are now unstaggered in the vertical; all prognostic
    variables are carried on the layer interfaces. This reduces computational
    modes caused by vertical averaging. Accuracy for vertical integrals (3rd order)
    and derivatives (2nd order) is maintained via the quadrature scheme of
    Leslie and Purser (1992, Meteorol. Atmos. Phys. 50, 61-73). Interface diagnostic
    variables, which used to end in "3" like "P3", now are plain without the 3;
    layer variables are still distinguished with a "2" like "RHO2".

 2) Horizontal-area map factors are now a function of height as well as latitude, which allows
    the model to maintain geometric accuracy over a large range of planetary radius. 

 3) Gravity is now a function of height and latitude, based on
    the planet's Omega, J2 and GM. Saturn in particular has a large variation in g with latitude.

 4) The model now defaults to a finite-volume formulation for the horizontal pressure-gradient 
    force.  This reduces spurious values in steep terrain.

 5) The hybrid-coordinate function g_sigma() has been rewritten using a tanh() function to
    step from 0 to 1. This improves the vertical velocity, W, and the stability of the model.

 6) For arrays, the model is now writing and reading from epic.nc layers K = 0 to grid.nk
    (instead of 1 to grid.nk), which includes the top and bottom interfaces of the model.
    The epic.nc file format now includes P3, full pressure on the interfaces, instead of
    HDRY, the dry hybrid density in the layers, since pressure is more intuitive and
    a density field does not contain information about the pressure at the top of the model.

 7) Time is now computed as UTC calendar time, instead of arbitrary time, 
    to facilitate models with seasonal forcing. The model's starting time is user specified.
    The macro TIME behaves as before, giving the elapsed time since this start in seconds
    as a floating point number.

 8) Keplerian orbital elements are now included for calculation of orbit position, plus
    season with respect to time, for Epoch J2000.

 9) We are now distinguishing between the sidereal and synodic angular velocities for
    planetary rotation (planet->omega_sidereal and planet->omega_synodic).

10) The model's path environment variable has been changed from "EPIC_PATH" to "EPIC4_PATH".
    The version without the "4" now refers to the older EPIC Version 3 (the pure-isentropic
    coordinate model). Making this distinction facilitates compiling different versions
    of the model on the same computer.

11) The executable epic (and mpi_epic) now gets its t_vs_p and t_cool_vs_p profiles from
    the input epic.nc file, rather than reading them in at runtime from epic/data.  The 
    executable initial now looks for these profiles, as well as u_vs_lat, in the local 
    directory first, and then in epic/data.

12) The EPIC user community now has a wiki site: http://epicwiki.atmos.louisville.edu

13) Fixed known bugs.

===========
Version 4.2
===========

T. Dowling (10/2007):

 1) Advection of theta in the sigma region improved from the 1st-order
    upwind scheme, which is highly dissipative and therefore undesirable,
    to the Hsu predictor corrector or Akima monotonized, centered scheme.
    The Hsu scheme is the default and is recommended.

 2) Improved hyperviscosity operators.  The meridional hyperviscosity
    now uses finite-difference weights generated by fitting the first
    three Legendre polynomials to the 3-pt stencil. This greatly improves
    the model's behavior at the poles. It alse runs faster than the previous
    algorithm.  The zonal hyperviscosity is now based on the Crank-Nicolson
    scheme, which provides both stability and accuracy.

 3) Added the option of Fred Fritsch's PCHIP 
    monotonic spline.  The issue is that a regular cubic spline is smooth 
    but not monotonic, whereas the PCHIP (piecewise cubic
    Hermite interpolating polynomial) spline is both smooth and monotonic.

 4) Added the Akima advection scheme as an option.  As with other centered,
    fourth-order schemes, this one is noisy and typically requires biharmonic
    hyperviscosity (nu4) to keep under control.  However, it provides a
    useful alternative to the Hsu predictor corrector.

 5) Upgraded the netcdf output files (epic.nc, extract.nc) to meet the 
    Climate and Forecast (CF) and Common Data Model (CDM) metadata conventions.
    This means that plotting packages like Panoply and IDV will automatically
    recognize the variables, units, and axes in EPIC output files.

 6) Fixed known bugs.


===========
Version 4.1
===========

T. Dowling (09/2006):

 1) Included Jupiter cloud microphysics model. (Csaba Palotai)
 2) Now maintaining bottom pressure as constant for the gas-giant case.
    This fixes a bug that was causing vortices to not hold together, which
    stemmed from the calculation of the bottom geopotential via gradient
    balance; we were using the constant-pressure formulation but allowing
    the bottom pressure to evolve.  Now, 'sigma' is
    a pressure coordinate for the gas-giant case.  The terrestrial
    case is unaffected by this change. (Tim Dowling)
 3) Added new initialization scheme based on inversion of an elliptic problem
    (Aaron Herrnstein).  This yields improved initial balance between
    the mass and momentum fields.
 4) Latest Matlab tools. (Aaron Herrnstein)
 9) Fixed known bugs.

===========
Version 4.0
===========

T. Dowling (8/2005):

  1) Converted to hybrid isentropic-sigma vertical coordinate.
  2) Added terrestrial planets.
  3) Added phase changes and latent heating of multiple condensables.
  4) Converted remaining Fortran subroutines into C.
  5) Fixed known bugs.

===========
Version 3.9
===========

T. Dowling (12/2002):

This version number was reserved for Adam Showman for some independent
development.

===========
Version 3.8
===========

T. Dowling (7/1998):

  1) Incorporated P. Gierasch's saturation vapor-pressure fortran 
     functions.
  2) Switched to the NetCDF standard (Network Common Data Format). 
  3) Added chemical_elements.h, which contains the atomic numbers,
     names, symbols, molar masses (atomic weights), and solar 
     abundances of the elements.
  4) Added specific humidities (water, ammonia, methane, etc.)
     as optional prognostic variables.
  5) Fixed known bugs.
 

===========
Version 3.7
===========

T. Dowling (4/1998):

  1) Added virial equation of state. The choices are now "ideal" and
     "virial."
  2) 1st and 2nd time steps now use 1st and 2nd order Adams-Bashforth
     steps, instead of a cold start (zero tendencies) for the model's 
     3rd order Adams-Bashforth time step.
  3) Switched from rsh to ssh (secure remote shell) for EPIC_Receive
     AVS module.
  4) Voyager velocity data files for Jupiter's Great Red Spot and White 
     Oval BC now included in $EPIC4_PATH/data/jupiter.
  5) Fixed known bugs.

===========
Version 3.6
===========

T. Dowling (4/1998):

First version posted on the NASA Planetary Data System (PDS)
Atmospheres Node.

The EPIC Model is described in Dowling et al (1998, Icarus 132, 221-238) 
"The Explicit Planetary Isentropic Coordinate (EPIC) Atmospheric Model."

C. Santori (5/30/1997):

 1) u_vs_lat.saturn: u at 89S latitude changed from 16.20 to 16.30.
 2) mqspec structure added to epic.h.
 3) Definitions of initialization types (search for SORPTOP) added to epic.h.
 4) Function prototypes for mont_from_q and low_mode added to epic.h.
 5) epic_init_funcs.c replaced entirely.
 6) Section inside "else if (grid.init_type == USE_Q_VS_M) {" replaced.
 7) epic_init_eigen.c added to epic/src/shared.
 8) Makefile.epic: epic_init_eigen.c added, mimicking epic_init_funcs.c.
 9) Spinup questions removed for case Q(M).
10) New defaults added.


